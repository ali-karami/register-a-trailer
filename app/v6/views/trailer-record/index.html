{% extends "layout-v6.html" %}

{% block page_title %} Trailer record {% endblock %}

{% block after_header %}
    {% include "includes/phase-banner/standard-noback.html" %}
{% endblock %}





{% block content %}
    <main id="content" class="trailer-record" role="main">
        <div class="grid-row">
            <div class="column-full">
                <span class="heading-section">
                    <span class="heading">
                        <h1 class="heading-large">
                            <span class="caption large">Name</span>
                            Trailer record
                        </h1>
                    </span>
                    <span class="change">
                        <span><a href="/trailer-record/change-details"><strong>Change<span id="record-type"> company</span> details</strong></a></span>
                    </span>

                    <div class="clear"></div>
                </span>

                <p id="no-trailers">You have not registered any trailers.</p>

                <div class="form-group">
                    <button class="button">Register trailers</button>
                </div>

                <div id="trailer-bar"></div>


                <!-- <dl>
                        <dt class="metadata-text-label">Registered on:</dt>
                        <dd class="metadata-text-value">Registered on:
                            <time datetime="2016-06-23">23 June 2016</time>
                        </dd>

                        <dt class="metadata-text-label">VIN:</dt>
                        <dd class="metadata-text-value">EXAMPLEVIN001</dd>

                        <dt class="metadata-text-label">FR fee:</dt>
                        <dd class="metadata-text-value">£55</dd>


                        <dt class="metadata-date-label">VED:</dt>
                        <dd class="metadata-date-value">£140</dd>
                    </dl>


                <dl>
                    <lh class="heading-small">Registration NUmber</lh>
                    <lh class="heading-small">Registration NUmber</lh>
                    <lh class="heading-small">Registration NUmber</lh>
                    <div class="row">
                        <dt>Registration NUmber</dt>
                        <dd><span class="BodyType">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>VIN/Chassis number</dt>
                        <dd><span class="EngineCapacity">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>Manufacturer</dt>
                        <dd><span class="WheelPlan">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>Number of seats (including driver)</dt>
                        <dd><span class="SeatingCapacity">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>Manufacturer vehicle type</dt>
                        <dd><span class="ManufacturerVehicleType">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>Supplier code</dt>
                        <dd><span class="SupplierCode">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>MVRIS/MCRIS</dt>
                        <dd><span class="MVRIS">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>MVRIS/MCRIS make</dt>
                        <dd><span class="MVRISMake">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>MVRIS/MCRIS model</dt>
                        <dd><span class="MVRISModel">&nbsp;</span></dd>
                    </div>
                    <div class="row">
                        <dt>Propulsion</dt>
                        <dd><span class="Propulsion">&nbsp;</span></dd>
                    </div>
                </dl> -->


                
                <span id="trailer-table">
                </span>
            </div>
        </div>
    </main>
{% endblock %}





{% block body_end %}
    <script type="text/javascript" src="/public/v6/javascripts/sortable-table.js"></script>

    <script type="text/javascript">
        try {
            $('.heading-large span').html(member.user.name).css('text-transform', 'capitalize');
        } catch(err){
            $('.caption.large').hide();
        }

        delete member.currentTrailer;
        delete member.currentTrailerPosition;

        getRegisteredTrailers();

        // Create trailer record table
        try {
            if (registeredTrailers === 0) {
                $('#trailer-bar').hide();
            } else {
                $('#no-trailers').hide();

                var trailerRow = '<h2 class="heading-medium">' + registeredTrailers + ' trailer<span class="plural"></span></h2>\
                <table id="sortable-table">\
                        <thead>\
                        <tr>\
                            <th scope="col" onclick="sortTable(0)" id="reg" class="sort-default">Registration number</th>\
                            <th scope="col" onclick="sortTable(1)" id="vin" class="sort-default">VIN/Chassis number</th>\
                            <th scope="col" onclick="sortTable(2)" id="manu" class="sort-default">Manufacturer</th>\
                            <th scope="col">&nbsp;</th>\
                        </tr>\
                    </thead>\
                <tbody>';
                for (i = 0; i < member.trailers.length; i++) {
                    if (member.trailers[i].registered == true) {
                        trailerRow += '<tr>';
                        trailerRow += '<td scope="row"><span class="table-label">Registration</span><span class="table-details">' + member.trailers[i].reg + '</span><a href="#" class="manage-link" data="' + i + '">Manage</a></td>';
                        if (!member.trailers[i].vin) {
                        } else {
                            trailerRow += '<td scope="row"><span class="table-label">VIN</span><span class="table-details">' + member.trailers[i].vin + '</span></td>';
                        }
                        if (!member.trailers[i].chassis) {
                        } else {
                            trailerRow += '<td scope="row"><span class="table-label">VIN/Chassis</span><span class="table-details">' + member.trailers[i].chassis + '</span></td>';
                        }
                        trailerRow += '<td scope="row"><span class="table-label">Manufacturer</span><span class="table-details">' + member.trailers[i].manufacturer + '</span></td>';
                        trailerRow += '<td scope="row" id="manage"><a href="#" class="manage" data="' + i + '">Manage</a></td>';
                        // trailerRow += '<a href="#" class="manage-link" data="' + i + '">Manage</a>';
                        trailerRow += '</tr>';
                    }
                }

                $('#trailer-table').html(trailerRow + '</tbody></table>');
            }
        } catch(err){}

        $('td a.manage').click(function(e) {
            e.preventDefault();
            var trailer = $(this).attr('data');
            member.currentTrailerPosition = trailer;
            go('/trailer-record/manage');
        });

        $('th#reg').click(function () {
            if ($(this).hasClass('sort-default')) {
                $(this).removeClass('sort-default').addClass('sort-a-z');
            } else if ($(this).hasClass('sort-a-z')) {
                $(this).removeClass('sort-a-z').addClass('sort-z-a');
            } else {
                $(this).removeClass('sort-z-a').addClass('sort-default');
            }
            $('th#vin').removeClass().addClass('sort-default');
            $('th#manu').removeClass().addClass('sort-default');
        });
        $('th#vin').click(function () {
            if ($(this).hasClass('sort-default')) {
                $(this).removeClass('sort-default').addClass('sort-a-z');
            } else if ($(this).hasClass('sort-a-z')) {
                $(this).removeClass('sort-a-z').addClass('sort-z-a');
            } else {
                $(this).removeClass('sort-z-a').addClass('sort-default');
            }
            $('th#reg').removeClass().addClass('sort-default');
            $('th#manu').removeClass().addClass('sort-default');
        });
        $('th#manu').click(function () {
            if ($(this).hasClass('sort-default')) {
                $(this).removeClass('sort-default').addClass('sort-a-z');
            } else if ($(this).hasClass('sort-a-z')) {
                $(this).removeClass('sort-a-z').addClass('sort-z-a');
            } else {
                $(this).removeClass('sort-z-a').addClass('sort-default');
            }
            $('th#reg').removeClass().addClass('sort-default');
            $('th#vin').removeClass().addClass('sort-default');
        });

        $('.button').click(next);

        function next() {
            go('/register/declaration');
        }
    </script>
{% endblock %}